

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/baikel.jpg">
  <link rel="icon" href="/img/baikel.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="北海">
  <meta name="keywords" content="">
  
    <meta name="description" content="以 Ti2O3 为示例，cif 文件为： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# generated using pymatgendata_Ti2O3_symmetry_space_group_name_H-M   &#x27;P 1&#x27;_cell_length">
<meta property="og:type" content="article">
<meta property="og:title" content="关于磁矩特征的写入">
<meta property="og:url" content="http://baikelwang.github.io/2025/07/09/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E7%9A%84%E5%86%99%E5%85%A5/index.html">
<meta property="og:site_name" content="Baikel">
<meta property="og:description" content="以 Ti2O3 为示例，cif 文件为： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# generated using pymatgendata_Ti2O3_symmetry_space_group_name_H-M   &#x27;P 1&#x27;_cell_length">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://baikelwang.github.io/img/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E5%86%99%E5%85%A5/0.png">
<meta property="article:published_time" content="2025-07-09T14:39:43.256Z">
<meta property="article:modified_time" content="2025-07-09T14:39:43.256Z">
<meta property="article:author" content="北海">
<meta property="article:tag" content="MP">
<meta property="article:tag" content="CSAT">
<meta property="article:tag" content="科研">
<meta property="article:tag" content="凝聚态物理">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://baikelwang.github.io/img/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E5%86%99%E5%85%A5/0.png">
  
  
  
  <title>关于磁矩特征的写入 - Baikel</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"baikelwang.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Baikel</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/BG.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="关于磁矩特征的写入"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-09 22:39" pubdate>
          2025年7月9日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          48 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">关于磁矩特征的写入</h1>
            
            
              <div class="markdown-body">
                
                <p>以 Ti2O3 为示例，cif 文件为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># generated using pymatgen</span><br>data_Ti2O3<br>_symmetry_space_group_name_H-M   <span class="hljs-string">&#x27;P 1&#x27;</span><br>_cell_length_a   <span class="hljs-number">5.16780216</span><br>_cell_length_b   <span class="hljs-number">5.16780216</span><br>_cell_length_c   <span class="hljs-number">9.60760300</span><br>_cell_angle_alpha   <span class="hljs-number">90.00000000</span><br>_cell_angle_beta   <span class="hljs-number">90.00000000</span><br>_cell_angle_gamma   <span class="hljs-number">120.00000000</span><br>_symmetry_Int_Tables_number   <span class="hljs-number">1</span><br>_chemical_formula_structural   Ti2O3<br>_chemical_formula_sum   <span class="hljs-string">&#x27;Ti8 O12&#x27;</span><br>_cell_volume   <span class="hljs-number">222.20684815</span><br>_cell_formula_units_Z   <span class="hljs-number">4</span><br>loop_<br> _symmetry_equiv_pos_site_id<br> _symmetry_equiv_pos_as_xyz<br>  <span class="hljs-number">1</span>  <span class="hljs-string">&#x27;x, y, z&#x27;</span><br>loop_<br> _atom_site_type_symbol<br> _atom_site_label<br> _atom_site_symmetry_multiplicity<br> _atom_site_fract_x<br> _atom_site_fract_y<br> _atom_site_fract_z<br> _atom_site_occupancy<br>  Ti  Ti0  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.97654800</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti1  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.25000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti2  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti3  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.50000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti4  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.52345200</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti5  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.75000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti6  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.02345200</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti7  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.47654800</span>  <span class="hljs-number">1</span>  <br>  O  O8  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O9  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br>  O  O10  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O11  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O12  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O13  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br>  O  O14  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O15  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O16  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O17  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O18  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O19  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br></code></pre></td></tr></table></figure>

<p>可以在下面的原子 loop 矩阵中加入每个原子对应的标量磁矩 <font style="color:rgb(0, 0, 0);background-color:rgb(238, 238, 238);">_atom_site_moment </font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 头部信息不变</span><br>loop_<br> _atom_site_type_symbol<br> _atom_site_label<br> _atom_site_symmetry_multiplicity<br> _atom_site_fract_x<br> _atom_site_fract_y<br> _atom_site_fract_z<br> _atom_site_occupancy<br>  _atom_site_moment<br>  Ti  Ti0  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.97654800</span>  <span class="hljs-number">1</span>  <span class="hljs-number">5</span><br>  Ti  Ti1  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.25000000</span>  <span class="hljs-number">1</span>  <span class="hljs-number">5</span><br>  Ti  Ti2  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>  Ti  Ti3  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.50000000</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>  Ti  Ti4  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.52345200</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>  Ti  Ti5  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.75000000</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>  Ti  Ti6  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.02345200</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span><br>  Ti  Ti7  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.47654800</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span><br>  O  O8  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O9  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O10  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O11  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O12  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O13  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O14  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O15  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O16  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O17  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O18  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br>  O  O19  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>或者还可以写入矢量磁矩，但是需要 3 个分量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">loop_<br>_atom_site_label<br>_atom_site_moment_Cartn_x<br>_atom_site_moment_Cartn_y<br>_atom_site_moment_Cartn_z<br></code></pre></td></tr></table></figure>

<h2 id="如何获取每个原子的磁矩信息？"><a href="#如何获取每个原子的磁矩信息？" class="headerlink" title="如何获取每个原子的磁矩信息？"></a><font style="color:rgb(0, 0, 0);">如何获取每个原子的磁矩信息？</font></h2><p>我查阅<a target="_blank" rel="noopener" href="https://next-gen.materialsproject.org/materials/mp-776655?formula=Ti2O3#more">https://next-gen.materialsproject.org/materials/mp-776655?formula=Ti2O3#more</a></p>
<p>中含有磁矩信息</p>
<p><img src="/img/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E5%86%99%E5%85%A5/0.png" srcset="/img/loading.gif" lazyload></p>
<p>获取 Ti2O3 全部信息的方式为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> mp_api.client <span class="hljs-keyword">import</span> MPRester<br><span class="hljs-keyword">with</span> MPRester(api_key=<span class="hljs-string">&quot;igRHy7zYOKzWD18jY76XtjbwEpRl6SoH&quot;</span>) <span class="hljs-keyword">as</span> mpr:<br>    data = mpr.materials.search(material_ids=[<span class="hljs-string">&quot;mp-776655&quot;</span>])<br></code></pre></td></tr></table></figure>

<p>获取之后打印全部 data 信息得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs python">[MPDataDoc&lt;MaterialsDoc&gt;(<br>builder_meta=EmmetMeta(emmet_version=<span class="hljs-string">&#x27;0.84.3rc4&#x27;</span>,<br>                       pymatgen_version=<span class="hljs-string">&#x27;2024.11.13&#x27;</span>, <br>                       run_id=<span class="hljs-string">&#x27;ccba9c49-e919-43c2-8d4f-35b2d60eb94b&#x27;</span>, <br>                       batch_id=<span class="hljs-literal">None</span>, database_version=<span class="hljs-string">&#x27;2025.06.09&#x27;</span>, <br>                       build_date=datetime.datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">11</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">57</span>, <span class="hljs-number">42</span>, <span class="hljs-number">12000</span>, <br>                                                    tzinfo=datetime.timezone.utc), <br>                       license=<span class="hljs-string">&#x27;BY-C&#x27;</span>),<br>nsites=<span class="hljs-number">20</span>,<br>elements=[Element O, Element Ti],<br>nelements=<span class="hljs-number">2</span>,<br>composition=Composition(<span class="hljs-string">&#x27;Ti8 O12&#x27;</span>),<br>composition_reduced=Composition(<span class="hljs-string">&#x27;Ti2 O3&#x27;</span>),<br>formula_pretty=<span class="hljs-string">&#x27;Ti2O3&#x27;</span>,<br>formula_anonymous=<span class="hljs-string">&#x27;A2B3&#x27;</span>,<br>chemsys=<span class="hljs-string">&#x27;O-Ti&#x27;</span>,<br>volume=<span class="hljs-number">217.75988736026858</span>,<br>density=<span class="hljs-number">4.384148726776235</span>,<br>density_atomic=<span class="hljs-number">10.887994368013429</span>,<br>symmetry=SymmetryData(crystal_system=&lt;CrystalSystem.trig: <span class="hljs-string">&#x27;Trigonal&#x27;</span>&gt;, symbol=<span class="hljs-string">&#x27;P-31c&#x27;</span>, number=<span class="hljs-number">163</span>, point_group=<span class="hljs-string">&#x27;-3m&#x27;</span>, symprec=<span class="hljs-number">0.1</span>, angle_tolerance=<span class="hljs-number">5.0</span>, version=<span class="hljs-string">&#x27;2.5.0&#x27;</span>),<br>material_id=MPID(mp-<span class="hljs-number">776655</span>),<br>structure=Structure Summary<br>Lattice<br>    abc : <span class="hljs-number">5.151006976476778</span> <span class="hljs-number">5.150980372462452</span> <span class="hljs-number">9.476884040021895</span><br> angles : <span class="hljs-number">90.0000031964729</span> <span class="hljs-number">90.0002147954698</span> <span class="hljs-number">120.00007956211232</span><br> volume : <span class="hljs-number">217.75988736026858</span><br>      A : <span class="hljs-number">2.57550686</span> -<span class="hljs-number">4.46090095</span> -<span class="hljs-number">9.72e-06</span><br>      B : <span class="hljs-number">2.57548062</span> <span class="hljs-number">4.46088538</span> -<span class="hljs-number">2.9e-07</span><br>      C : -<span class="hljs-number">1.764e-05</span> <span class="hljs-number">1.019e-05</span> <span class="hljs-number">9.47688404</span><br>    pbc : <span class="hljs-literal">True</span> <span class="hljs-literal">True</span> <span class="hljs-literal">True</span><br>PeriodicSite: Ti (<span class="hljs-number">2.575</span>, <span class="hljs-number">1.487</span>, <span class="hljs-number">9.24</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.975</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.575</span>, <span class="hljs-number">1.487</span>, <span class="hljs-number">2.369</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.25</span>]<br>PeriodicSite: Ti (-<span class="hljs-number">1.857e-05</span>, <span class="hljs-number">1.073e-05</span>, <span class="hljs-number">9.477</span>) [-<span class="hljs-number">2.4e-07</span>, -<span class="hljs-number">1.2e-07</span>, <span class="hljs-number">1.0</span>]<br>PeriodicSite: Ti (-<span class="hljs-number">4.39e-06</span>, <span class="hljs-number">1.518e-05</span>, <span class="hljs-number">4.739</span>) [-<span class="hljs-number">2.7e-07</span>, <span class="hljs-number">1.99e-06</span>, <span class="hljs-number">0.5</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.575</span>, <span class="hljs-number">1.487</span>, <span class="hljs-number">4.975</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.525</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.575</span>, -<span class="hljs-number">1.487</span>, <span class="hljs-number">7.108</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.75</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.576</span>, -<span class="hljs-number">1.487</span>, <span class="hljs-number">0.2363</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.02494</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.576</span>, -<span class="hljs-number">1.487</span>, <span class="hljs-number">4.502</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.4751</span>]<br>PeriodicSite: O (<span class="hljs-number">1.803</span>, <span class="hljs-number">2.894</span>, <span class="hljs-number">1.104</span>) [<span class="hljs-number">0.02568</span>, <span class="hljs-number">0.6744</span>, <span class="hljs-number">0.1165</span>]<br>PeriodicSite: O (<span class="hljs-number">4.18</span>, -<span class="hljs-number">1.453</span>, <span class="hljs-number">5.843</span>) [<span class="hljs-number">0.9743</span>, <span class="hljs-number">0.6487</span>, <span class="hljs-number">0.6166</span>]<br>PeriodicSite: O (<span class="hljs-number">0.971</span>, <span class="hljs-number">1.452</span>, <span class="hljs-number">3.634</span>) [<span class="hljs-number">0.0257</span>, <span class="hljs-number">0.3513</span>, <span class="hljs-number">0.3835</span>]<br>PeriodicSite: O (<span class="hljs-number">3.348</span>, -<span class="hljs-number">2.894</span>, <span class="hljs-number">8.372</span>) [<span class="hljs-number">0.9743</span>, <span class="hljs-number">0.3256</span>, <span class="hljs-number">0.8834</span>]<br>PeriodicSite: O (<span class="hljs-number">1.743</span>, <span class="hljs-number">0.1145</span>, <span class="hljs-number">1.104</span>) [<span class="hljs-number">0.3256</span>, <span class="hljs-number">0.3513</span>, <span class="hljs-number">0.1165</span>]<br>PeriodicSite: O (<span class="hljs-number">1.743</span>, -<span class="hljs-number">0.1146</span>, <span class="hljs-number">5.843</span>) [<span class="hljs-number">0.3513</span>, <span class="hljs-number">0.3256</span>, <span class="hljs-number">0.6166</span>]<br>PeriodicSite: O (<span class="hljs-number">3.348</span>, <span class="hljs-number">2.894</span>, <span class="hljs-number">3.634</span>) [<span class="hljs-number">0.3256</span>, <span class="hljs-number">0.9743</span>, <span class="hljs-number">0.3835</span>]<br>PeriodicSite: O (<span class="hljs-number">0.9709</span>, -<span class="hljs-number">1.452</span>, <span class="hljs-number">8.372</span>) [<span class="hljs-number">0.3513</span>, <span class="hljs-number">0.02569</span>, <span class="hljs-number">0.8834</span>]<br>PeriodicSite: O (<span class="hljs-number">3.408</span>, <span class="hljs-number">0.1146</span>, <span class="hljs-number">3.634</span>) [<span class="hljs-number">0.6487</span>, <span class="hljs-number">0.6744</span>, <span class="hljs-number">0.3835</span>]<br>PeriodicSite: O (<span class="hljs-number">3.408</span>, -<span class="hljs-number">0.1146</span>, <span class="hljs-number">8.372</span>) [<span class="hljs-number">0.6744</span>, <span class="hljs-number">0.6487</span>, <span class="hljs-number">0.8834</span>]<br>PeriodicSite: O (<span class="hljs-number">4.18</span>, <span class="hljs-number">1.452</span>, <span class="hljs-number">1.104</span>) [<span class="hljs-number">0.6487</span>, <span class="hljs-number">0.9743</span>, <span class="hljs-number">0.1165</span>]<br>PeriodicSite: O (<span class="hljs-number">1.803</span>, -<span class="hljs-number">2.894</span>, <span class="hljs-number">5.843</span>) [<span class="hljs-number">0.6744</span>, <span class="hljs-number">0.02568</span>, <span class="hljs-number">0.6166</span>],<br>deprecated=<span class="hljs-literal">False</span>,<br>deprecation_reasons=<span class="hljs-literal">None</span>,<br>initial_structures=[Structure Summary<br>Lattice<br>    abc : <span class="hljs-number">5.167048146727587</span> <span class="hljs-number">5.167048146727587</span> <span class="hljs-number">9.607603</span><br> angles : <span class="hljs-number">90.0</span> <span class="hljs-number">90.0</span> <span class="hljs-number">120.00000187871662</span><br> volume : <span class="hljs-number">222.14200594619678</span><br>      A : <span class="hljs-number">2.583523999999999</span> -<span class="hljs-number">4.474795</span> <span class="hljs-number">0.0</span><br>      B : <span class="hljs-number">2.583523999999999</span> <span class="hljs-number">4.474795</span> <span class="hljs-number">0.0</span><br>      C : <span class="hljs-number">0.0</span> <span class="hljs-number">0.0</span> <span class="hljs-number">9.607603</span><br>    pbc : <span class="hljs-literal">True</span> <span class="hljs-literal">True</span> <span class="hljs-literal">True</span><br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, <span class="hljs-number">1.492</span>, <span class="hljs-number">9.382</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.9765</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, <span class="hljs-number">1.492</span>, <span class="hljs-number">2.402</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.25</span>]<br>PeriodicSite: Ti (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>) [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>]<br>PeriodicSite: Ti (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">4.804</span>) [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.5</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, <span class="hljs-number">1.492</span>, <span class="hljs-number">5.029</span>) [<span class="hljs-number">0.3333</span>, <span class="hljs-number">0.6667</span>, <span class="hljs-number">0.5235</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, -<span class="hljs-number">1.492</span>, <span class="hljs-number">7.206</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.75</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, -<span class="hljs-number">1.492</span>, <span class="hljs-number">0.2253</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.02345</span>]<br>PeriodicSite: Ti (<span class="hljs-number">2.584</span>, -<span class="hljs-number">1.492</span>, <span class="hljs-number">4.578</span>) [<span class="hljs-number">0.6667</span>, <span class="hljs-number">0.3333</span>, <span class="hljs-number">0.4765</span>]<br>PeriodicSite: O (<span class="hljs-number">1.743</span>, <span class="hljs-number">0.1157</span>, <span class="hljs-number">1.118</span>) [<span class="hljs-number">0.3244</span>, <span class="hljs-number">0.3503</span>, <span class="hljs-number">0.1164</span>]<br>PeriodicSite: O (<span class="hljs-number">1.743</span>, -<span class="hljs-number">0.1157</span>, <span class="hljs-number">5.922</span>) [<span class="hljs-number">0.3503</span>, <span class="hljs-number">0.3244</span>, <span class="hljs-number">0.6164</span>]<br>PeriodicSite: O (<span class="hljs-number">3.424</span>, <span class="hljs-number">0.1157</span>, <span class="hljs-number">3.685</span>) [<span class="hljs-number">0.6497</span>, <span class="hljs-number">0.6756</span>, <span class="hljs-number">0.3836</span>]<br>PeriodicSite: O (<span class="hljs-number">3.424</span>, -<span class="hljs-number">0.1157</span>, <span class="hljs-number">8.489</span>) [<span class="hljs-number">0.6756</span>, <span class="hljs-number">0.6497</span>, <span class="hljs-number">0.8836</span>]<br>PeriodicSite: O (<span class="hljs-number">4.195</span>, <span class="hljs-number">1.452</span>, <span class="hljs-number">1.118</span>) [<span class="hljs-number">0.6497</span>, <span class="hljs-number">0.9741</span>, <span class="hljs-number">0.1164</span>]<br>PeriodicSite: O (<span class="hljs-number">1.812</span>, -<span class="hljs-number">2.907</span>, <span class="hljs-number">5.922</span>) [<span class="hljs-number">0.6756</span>, <span class="hljs-number">0.02586</span>, <span class="hljs-number">0.6164</span>]<br>PeriodicSite: O (<span class="hljs-number">0.9718</span>, <span class="hljs-number">1.452</span>, <span class="hljs-number">3.685</span>) [<span class="hljs-number">0.02586</span>, <span class="hljs-number">0.3503</span>, <span class="hljs-number">0.3836</span>]<br>PeriodicSite: O (<span class="hljs-number">3.355</span>, -<span class="hljs-number">2.907</span>, <span class="hljs-number">8.489</span>) [<span class="hljs-number">0.9741</span>, <span class="hljs-number">0.3244</span>, <span class="hljs-number">0.8836</span>]<br>PeriodicSite: O (<span class="hljs-number">3.355</span>, <span class="hljs-number">2.907</span>, <span class="hljs-number">3.685</span>) [<span class="hljs-number">0.3244</span>, <span class="hljs-number">0.9741</span>, <span class="hljs-number">0.3836</span>]<br>PeriodicSite: O (<span class="hljs-number">0.9718</span>, -<span class="hljs-number">1.452</span>, <span class="hljs-number">8.489</span>) [<span class="hljs-number">0.3503</span>, <span class="hljs-number">0.02586</span>, <span class="hljs-number">0.8836</span>]<br>PeriodicSite: O (<span class="hljs-number">1.812</span>, <span class="hljs-number">2.907</span>, <span class="hljs-number">1.118</span>) [<span class="hljs-number">0.02586</span>, <span class="hljs-number">0.6756</span>, <span class="hljs-number">0.1164</span>]<br>PeriodicSite: O (<span class="hljs-number">4.195</span>, -<span class="hljs-number">1.452</span>, <span class="hljs-number">5.922</span>) [<span class="hljs-number">0.9741</span>, <span class="hljs-number">0.6497</span>, <span class="hljs-number">0.6164</span>]],<br>task_ids=[MPID(mp-<span class="hljs-number">2739261</span>), MPID(mp-<span class="hljs-number">2739212</span>), MPID(mp-<span class="hljs-number">888770</span>), MPID(mp-<span class="hljs-number">1784547</span>), MPID(mp-<span class="hljs-number">902522</span>), MPID(mp-<span class="hljs-number">903281</span>), MPID(mp-<span class="hljs-number">1367622</span>), MPID(mp-<span class="hljs-number">776655</span>)],<br>deprecated_tasks=[],<br>calc_types=&#123;<span class="hljs-string">&#x27;mp-902522&#x27;</span>: &lt;CalcType.GGA_NSCF_Line: <span class="hljs-string">&#x27;GGA NSCF Line&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-776655&#x27;</span>: &lt;CalcType.GGA_Structure_Optimization: <span class="hljs-string">&#x27;GGA Structure Optimization&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-888770&#x27;</span>: &lt;CalcType.GGA_Static: <span class="hljs-string">&#x27;GGA Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1367622&#x27;</span>: &lt;CalcType.GGA_Static: <span class="hljs-string">&#x27;GGA Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1784547&#x27;</span>: &lt;CalcType.GGA_Static: <span class="hljs-string">&#x27;GGA Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-903281&#x27;</span>: &lt;CalcType.GGA_NSCF_Line: <span class="hljs-string">&#x27;GGA NSCF Line&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739212&#x27;</span>: &lt;CalcType.PBEsol_Structure_Optimization: <span class="hljs-string">&#x27;PBEsol Structure Optimization&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739261&#x27;</span>: &lt;CalcType.r2SCAN_Structure_Optimization: <span class="hljs-string">&#x27;r2SCAN Structure Optimization&#x27;</span>&gt;&#125;,<br>last_updated=datetime.datetime(<span class="hljs-number">2021</span>, <span class="hljs-number">7</span>, <span class="hljs-number">25</span>, <span class="hljs-number">14</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">198000</span>, tzinfo=datetime.timezone.utc),<br>created_at=datetime.datetime(<span class="hljs-number">2014</span>, <span class="hljs-number">2</span>, <span class="hljs-number">22</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">31</span>, tzinfo=datetime.timezone.utc),<br>origins=[PropertyOrigin(name=<span class="hljs-string">&#x27;structure&#x27;</span>, task_id=MPID(mp-<span class="hljs-number">2739261</span>), last_updated=datetime.datetime(<span class="hljs-number">2021</span>, <span class="hljs-number">7</span>, <span class="hljs-number">25</span>, <span class="hljs-number">14</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">198000</span>, tzinfo=datetime.timezone.utc))],<br>warnings=[],<br>task_types=&#123;<span class="hljs-string">&#x27;mp-902522&#x27;</span>: &lt;TaskType.NSCF_Line: <span class="hljs-string">&#x27;NSCF Line&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-776655&#x27;</span>: &lt;TaskType.Structure_Optimization: <span class="hljs-string">&#x27;Structure Optimization&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-888770&#x27;</span>: &lt;TaskType.Static: <span class="hljs-string">&#x27;Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1367622&#x27;</span>: &lt;TaskType.Static: <span class="hljs-string">&#x27;Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1784547&#x27;</span>: &lt;TaskType.Static: <span class="hljs-string">&#x27;Static&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-903281&#x27;</span>: &lt;TaskType.NSCF_Line: <span class="hljs-string">&#x27;NSCF Line&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739212&#x27;</span>: &lt;TaskType.Structure_Optimization: <span class="hljs-string">&#x27;Structure Optimization&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739261&#x27;</span>: &lt;TaskType.Structure_Optimization: <span class="hljs-string">&#x27;Structure Optimization&#x27;</span>&gt;&#125;,<br>run_types=&#123;<span class="hljs-string">&#x27;mp-902522&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-776655&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-888770&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1367622&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-1784547&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-903281&#x27;</span>: &lt;RunType.GGA: <span class="hljs-string">&#x27;GGA&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739212&#x27;</span>: &lt;RunType.PBEsol: <span class="hljs-string">&#x27;PBEsol&#x27;</span>&gt;, <span class="hljs-string">&#x27;mp-2739261&#x27;</span>: &lt;RunType.r2SCAN: <span class="hljs-string">&#x27;r2SCAN&#x27;</span>&gt;&#125;,<br>entries=BlessedCalcs(GGA=mp-<span class="hljs-number">776655</span>-GGA ComputedStructureEntry - Ti8 O12      (Ti2O3)<br>Energy (Uncorrected)     = -<span class="hljs-number">178.7848</span> eV (-<span class="hljs-number">8.9392</span>  eV/atom)<br>Correction               = <span class="hljs-number">0.0000</span>    eV (<span class="hljs-number">0.0000</span>   eV/atom)<br>Energy (Final)           = -<span class="hljs-number">178.7848</span> eV (-<span class="hljs-number">8.9392</span>  eV/atom)<br>Energy Adjustments:<br>  <span class="hljs-literal">None</span><br>Parameters:<br>  potcar_spec            = [&#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE Ti_pv 07Sep2000&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;70bc3ea8bf68f10e7e1e4721bb91972a&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;, &#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE O 08Apr2002&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;7a25bc5b9a5393f46600a4939d357982&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;]<br>  run_type               = GGA<br>  is_hubbard             = <span class="hljs-literal">False</span><br>  hubbards               = <span class="hljs-literal">None</span><br>Data:<br>  oxide_type             = oxide<br>  aspherical             = <span class="hljs-literal">True</span><br>  last_updated           = <span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-<span class="hljs-number">21</span> <span class="hljs-number">22</span>:<span class="hljs-number">57</span>:<span class="hljs-number">41.717606</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>  task_id                = mp-<span class="hljs-number">1784547</span><br>  material_id            = mp-<span class="hljs-number">776655</span>, GGA_U=<span class="hljs-literal">None</span>, PBESol=mp-<span class="hljs-number">776655</span>-PBEsol ComputedStructureEntry - Ti8 O12      (Ti2O3)<br>Energy (Uncorrected)     = -<span class="hljs-number">186.9983</span> eV (-<span class="hljs-number">9.3499</span>  eV/atom)<br>Correction               = <span class="hljs-number">0.0000</span>    eV (<span class="hljs-number">0.0000</span>   eV/atom)<br>Energy (Final)           = -<span class="hljs-number">186.9983</span> eV (-<span class="hljs-number">9.3499</span>  eV/atom)<br>Energy Adjustments:<br>  <span class="hljs-literal">None</span><br>Parameters:<br>  potcar_spec            = [&#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE Ti_pv 07Sep2000&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;cdd047e254a1247dbf5c1bb0563a75b9&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;, &#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE O 08Apr2002&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;9bb4b91e6c47f70fd2bce603bd5d6832&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;]<br>  run_type               = PBEsol<br>  is_hubbard             = <span class="hljs-literal">False</span><br>  hubbards               = <span class="hljs-literal">None</span><br>Data:<br>  oxide_type             = oxide<br>  aspherical             = <span class="hljs-literal">True</span><br>  last_updated           = <span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-<span class="hljs-number">21</span> <span class="hljs-number">22</span>:<span class="hljs-number">57</span>:<span class="hljs-number">41.767313</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>  task_id                = mp-<span class="hljs-number">2739212</span><br>  material_id            = mp-<span class="hljs-number">776655</span>, SCAN=<span class="hljs-literal">None</span>, R2SCAN=mp-<span class="hljs-number">776655</span>-r2SCAN ComputedStructureEntry - Ti8 O12      (Ti2O3)<br>Energy (Uncorrected)     = -<span class="hljs-number">236.5932</span> eV (-<span class="hljs-number">11.8297</span> eV/atom)<br>Correction               = <span class="hljs-number">0.0000</span>    eV (<span class="hljs-number">0.0000</span>   eV/atom)<br>Energy (Final)           = -<span class="hljs-number">236.5932</span> eV (-<span class="hljs-number">11.8297</span> eV/atom)<br>Energy Adjustments:<br>  <span class="hljs-literal">None</span><br>Parameters:<br>  potcar_spec            = [&#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE Ti_pv 07Sep2000&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;cdd047e254a1247dbf5c1bb0563a75b9&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;, &#123;<span class="hljs-string">&#x27;titel&#x27;</span>: <span class="hljs-string">&#x27;PAW_PBE O 08Apr2002&#x27;</span>, <span class="hljs-string">&#x27;hash&#x27;</span>: <span class="hljs-string">&#x27;9bb4b91e6c47f70fd2bce603bd5d6832&#x27;</span>, <span class="hljs-string">&#x27;summary_stats&#x27;</span>: <span class="hljs-literal">None</span>&#125;]<br>  run_type               = r2SCAN<br>  is_hubbard             = <span class="hljs-literal">False</span><br>  hubbards               = <span class="hljs-literal">None</span><br>Data:<br>  oxide_type             = oxide<br>  aspherical             = <span class="hljs-literal">True</span><br>  last_updated           = <span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-<span class="hljs-number">21</span> <span class="hljs-number">22</span>:<span class="hljs-number">57</span>:<span class="hljs-number">41.802864</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>  task_id                = mp-<span class="hljs-number">2739261</span><br>  material_id            = mp-<span class="hljs-number">776655</span>, HSE=<span class="hljs-literal">None</span>),<br>fields_not_requested=[]<br>)]<br></code></pre></td></tr></table></figure>

<p>发现 structure 字段与我本地的 cif 文件不太一样，他多了一些额外的字段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">loop_<br> _atom_site_type_symbol<br> _atom_site_label<br> _atom_site_symmetry_multiplicity<br> _atom_site_fract_x<br> _atom_site_fract_y<br> _atom_site_fract_z<br> _atom_site_occupancy<br>  Ti  Ti0  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.97654800</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti1  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.25000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti2  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti3  <span class="hljs-number">1</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.00000000</span>  <span class="hljs-number">0.50000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti4  <span class="hljs-number">1</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.52345200</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti5  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.75000000</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti6  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.02345200</span>  <span class="hljs-number">1</span>  <br>  Ti  Ti7  <span class="hljs-number">1</span>  <span class="hljs-number">0.66666667</span>  <span class="hljs-number">0.33333333</span>  <span class="hljs-number">0.47654800</span>  <span class="hljs-number">1</span>  <br>  O  O8  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O9  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br>  O  O10  <span class="hljs-number">1</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O11  <span class="hljs-number">1</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O12  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O13  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br>  O  O14  <span class="hljs-number">1</span>  <span class="hljs-number">0.32444533</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O15  <span class="hljs-number">1</span>  <span class="hljs-number">0.35030267</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O16  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.38358300</span>  <span class="hljs-number">1</span>  <br>  O  O17  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.88358300</span>  <span class="hljs-number">1</span>  <br>  O  O18  <span class="hljs-number">1</span>  <span class="hljs-number">0.64969733</span>  <span class="hljs-number">0.97414267</span>  <span class="hljs-number">0.11641700</span>  <span class="hljs-number">1</span>  <br>  O  O19  <span class="hljs-number">1</span>  <span class="hljs-number">0.67555467</span>  <span class="hljs-number">0.02585733</span>  <span class="hljs-number">0.61641700</span>  <span class="hljs-number">1</span>  <br></code></pre></td></tr></table></figure>

<p>于是我就打印下来看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">Full Formula (Ti8 O12)<br>Reduced Formula: Ti2O3<br>abc   :   <span class="hljs-number">5.151007</span>   <span class="hljs-number">5.150980</span>   <span class="hljs-number">9.476884</span><br>angles:  <span class="hljs-number">90.000003</span>  <span class="hljs-number">90.000215</span> <span class="hljs-number">120.000080</span><br>pbc   :       <span class="hljs-literal">True</span>       <span class="hljs-literal">True</span>       <span class="hljs-literal">True</span><br>Sites (<span class="hljs-number">20</span>)<br>  <span class="hljs-comment">#  SP            a          b         c    magmom</span><br>---  ----  ---------  ---------  --------  --------<br>  <span class="hljs-number">0</span>  Ti     <span class="hljs-number">0.333332</span>   <span class="hljs-number">0.666663</span>  <span class="hljs-number">0.975046</span>     <span class="hljs-number">0.514</span><br>  <span class="hljs-number">1</span>  Ti     <span class="hljs-number">0.333334</span>   <span class="hljs-number">0.666667</span>  <span class="hljs-number">0.249997</span>    -<span class="hljs-number">0.112</span><br>  <span class="hljs-number">2</span>  Ti    -<span class="hljs-number">0</span>         -<span class="hljs-number">0</span>         <span class="hljs-number">0.999985</span>     <span class="hljs-number">0.906</span><br>  <span class="hljs-number">3</span>  Ti    -<span class="hljs-number">0</span>          <span class="hljs-number">2e-06</span>     <span class="hljs-number">0.500008</span>     <span class="hljs-number">0.906</span><br>  <span class="hljs-number">4</span>  Ti     <span class="hljs-number">0.333322</span>   <span class="hljs-number">0.666661</span>  <span class="hljs-number">0.524963</span>     <span class="hljs-number">0.514</span><br>  <span class="hljs-number">5</span>  Ti     <span class="hljs-number">0.666666</span>   <span class="hljs-number">0.333333</span>  <span class="hljs-number">0.750007</span>    -<span class="hljs-number">0.112</span><br>  <span class="hljs-number">6</span>  Ti     <span class="hljs-number">0.666668</span>   <span class="hljs-number">0.333337</span>  <span class="hljs-number">0.024937</span>     <span class="hljs-number">0.514</span><br>  <span class="hljs-number">7</span>  Ti     <span class="hljs-number">0.666677</span>   <span class="hljs-number">0.333337</span>  <span class="hljs-number">0.475051</span>     <span class="hljs-number">0.514</span><br>  <span class="hljs-number">8</span>  O      <span class="hljs-number">0.025681</span>   <span class="hljs-number">0.674403</span>  <span class="hljs-number">0.116537</span>    -<span class="hljs-number">0.007</span><br>  <span class="hljs-number">9</span>  O      <span class="hljs-number">0.974318</span>   <span class="hljs-number">0.648705</span>  <span class="hljs-number">0.616563</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">10</span>  O      <span class="hljs-number">0.0257</span>     <span class="hljs-number">0.351301</span>  <span class="hljs-number">0.383472</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">11</span>  O      <span class="hljs-number">0.974308</span>   <span class="hljs-number">0.325583</span>  <span class="hljs-number">0.883429</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">12</span>  O      <span class="hljs-number">0.325599</span>   <span class="hljs-number">0.351278</span>  <span class="hljs-number">0.116537</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">13</span>  O      <span class="hljs-number">0.351293</span>   <span class="hljs-number">0.32561</span>   <span class="hljs-number">0.61656</span>     -<span class="hljs-number">0.007</span><br> <span class="hljs-number">14</span>  O      <span class="hljs-number">0.3256</span>     <span class="hljs-number">0.974301</span>  <span class="hljs-number">0.383477</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">15</span>  O      <span class="hljs-number">0.351274</span>   <span class="hljs-number">0.02569</span>   <span class="hljs-number">0.88343</span>     -<span class="hljs-number">0.007</span><br> <span class="hljs-number">16</span>  O      <span class="hljs-number">0.648702</span>   <span class="hljs-number">0.674402</span>  <span class="hljs-number">0.383477</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">17</span>  O      <span class="hljs-number">0.674414</span>   <span class="hljs-number">0.648724</span>  <span class="hljs-number">0.883429</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">18</span>  O      <span class="hljs-number">0.648724</span>   <span class="hljs-number">0.974321</span>  <span class="hljs-number">0.116535</span>    -<span class="hljs-number">0.007</span><br> <span class="hljs-number">19</span>  O      <span class="hljs-number">0.674388</span>   <span class="hljs-number">0.025681</span>  <span class="hljs-number">0.61656</span>     -<span class="hljs-number">0.007</span><br></code></pre></td></tr></table></figure>

<p>可见 structure 中是含有原子磁矩的，于是我就将其重新写 cif，在这里我用了 2 种方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 方法一</span><br>structure.to(<span class="hljs-string">&quot;Ti2O3.cif&quot;</span>)<br><span class="hljs-comment"># 方法二</span><br><span class="hljs-keyword">from</span> pymatgen.io.cif <span class="hljs-keyword">import</span> CifWriter<br>cif_writer = CifWriter(structure, write_magmoms=<span class="hljs-literal">True</span>) <br><br><span class="hljs-comment">### Cifwriter的参数</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CifWriter</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;A wrapper around CifFile to write CIF files from pymatgen Structure.&quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"></span><br><span class="hljs-params">        self,</span><br><span class="hljs-params">        struct: Structure | IStructure,</span><br><span class="hljs-params">        symprec: <span class="hljs-built_in">float</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">        write_magmoms: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,</span><br><span class="hljs-params">        significant_figures: <span class="hljs-built_in">int</span> = <span class="hljs-number">8</span>,</span><br><span class="hljs-params">        angle_tolerance: <span class="hljs-built_in">float</span> = <span class="hljs-number">5</span>,</span><br><span class="hljs-params">        refine_struct: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>,</span><br><span class="hljs-params">        write_site_properties: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,</span><br><span class="hljs-params">    </span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            struct (Structure): structure to write.</span><br><span class="hljs-string">            symprec (float): If not none, finds the symmetry of the structure</span><br><span class="hljs-string">                and writes the CIF with symmetry information. Passes symprec</span><br><span class="hljs-string">                to the SpacegroupAnalyzer. See also refine_struct.</span><br><span class="hljs-string">            write_magmoms (bool): If True, will write magCIF file. Incompatible</span><br><span class="hljs-string">                with symprec</span><br><span class="hljs-string">            significant_figures (int): Specifies precision for formatting of floats.</span><br><span class="hljs-string">                Defaults to 8.</span><br><span class="hljs-string">            angle_tolerance (float): Angle tolerance for symmetry finding. Passes</span><br><span class="hljs-string">                angle_tolerance to the SpacegroupAnalyzer. Used only if symprec</span><br><span class="hljs-string">                is not None.</span><br><span class="hljs-string">            refine_struct: Used only if symprec is not None. If True, get_refined_structure</span><br><span class="hljs-string">                is invoked to convert input structure from primitive to conventional.</span><br><span class="hljs-string">            write_site_properties (bool): Whether to write the Structure.site_properties</span><br><span class="hljs-string">                to the CIF as _atom_site_&#123;property name&#125;. Defaults to False.</span><br><span class="hljs-string">            =====================================================================</span><br><span class="hljs-string">            struct (Structure): 待写入的晶体结构。</span><br><span class="hljs-string">            symprec (float): 若不为None，则分析结构的对称性并写入带对称性信息的CIF文件。</span><br><span class="hljs-string">            该参数会传递给空间群分析器(SpacegroupAnalyzer)。另见refine_struct参数说明。</span><br><span class="hljs-string">            write_magmoms (bool): 若为True，则写入磁矩信息生成magCIF文件。与symprec参数不兼容。</span><br><span class="hljs-string">            significant_figles (int): 浮点数格式化精度，默认保留8位有效数字。</span><br><span class="hljs-string">            angle_tolerance (float): 对称性分析的角度容差参数，传递给SpacegroupAnalyzer。</span><br><span class="hljs-string">            仅在symprec不为None时生效。</span><br><span class="hljs-string">            refine_struct (bool): 仅在symprec不为None时生效。若为True，则调用</span><br><span class="hljs-string">            get_refined_structure方法将原结构从原胞转换为晶胞常规形式。</span><br><span class="hljs-string">            write_site_properties (bool): 是否将Structure.site_properties中的属性</span><br><span class="hljs-string">            写入CIF的_atom_site_&#123;属性名&#125;字段，默认为False。  </span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<p>第一种方法是没有用的，第二种方法可以写入，得到以下矢量磁矩</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">loop_<br> _atom_site_moment_label<br> _atom_site_moment_crystalaxis_x<br> _atom_site_moment_crystalaxis_y<br> _atom_site_moment_crystalaxis_z<br>  Ti0  <span class="hljs-number">0.00000128</span>  <span class="hljs-number">0.00000064</span>  <span class="hljs-number">0.51400000</span><br>  Ti1  -<span class="hljs-number">0.00000028</span>  -<span class="hljs-number">0.00000014</span>  -<span class="hljs-number">0.11200000</span><br>  Ti2  <span class="hljs-number">0.00000225</span>  <span class="hljs-number">0.00000112</span>  <span class="hljs-number">0.90600000</span><br>  Ti3  <span class="hljs-number">0.00000225</span>  <span class="hljs-number">0.00000112</span>  <span class="hljs-number">0.90600000</span><br>  Ti4  <span class="hljs-number">0.00000128</span>  <span class="hljs-number">0.00000064</span>  <span class="hljs-number">0.51400000</span><br>  Ti5  -<span class="hljs-number">0.00000028</span>  -<span class="hljs-number">0.00000014</span>  -<span class="hljs-number">0.11200000</span><br>  Ti6  <span class="hljs-number">0.00000128</span>  <span class="hljs-number">0.00000064</span>  <span class="hljs-number">0.51400000</span><br>  Ti7  <span class="hljs-number">0.00000128</span>  <span class="hljs-number">0.00000064</span>  <span class="hljs-number">0.51400000</span><br>  O8  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O9  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O10  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O11  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O12  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O13  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O14  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O15  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O16  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O17  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O18  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br>  O19  -<span class="hljs-number">0.00000002</span>  <span class="hljs-number">0.00000000</span>  -<span class="hljs-number">0.00700000</span><br></code></pre></td></tr></table></figure>

<p>接下来尝试获取标量磁矩，试了很多方法，都失败了，而且很复杂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 提取矢量磁矩数据</span><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>vector_magmoms = structure.site_properties.get(<span class="hljs-string">&quot;magmom&quot;</span>, [])<br><br><span class="hljs-comment"># 计算标量磁矩（模长）</span><br>scalar_magmoms = []<br><span class="hljs-keyword">for</span> magmom <span class="hljs-keyword">in</span> vector_magmoms:<br>    <span class="hljs-comment"># 检查磁矩是否是矢量（列表/数组）还是标量</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(magmom, (<span class="hljs-built_in">list</span>, <span class="hljs-built_in">tuple</span>, np.ndarray)):<br>        <span class="hljs-comment"># 计算矢量模长作为标量磁矩</span><br>        scalar_magmoms.append(np.linalg.norm(magmom))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 如果已经是标量，直接使用</span><br>        scalar_magmoms.append(magmom)<br><br><span class="hljs-comment"># 使用CifWriter但添加自定义标量磁矩列</span><br>cif_writer = CifWriter(structure)<br>cif_file = cif_writer.cif_file<br><span class="hljs-comment"># 获取第一个数据块</span><br>data_block = <span class="hljs-built_in">next</span>(<span class="hljs-built_in">iter</span>(cif_file.data.values()))<br><span class="hljs-comment"># 添加标量磁矩数据</span><br>atom_labels = [<span class="hljs-string">f&quot;Ti<span class="hljs-subst">&#123;i&#125;</span>&quot;</span> <span class="hljs-keyword">if</span> s.species_string == <span class="hljs-string">&quot;Ti&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">f&quot;O<span class="hljs-subst">&#123;i&#125;</span>&quot;</span> <br>                <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(structure)]<br><br><span class="hljs-comment"># 添加标量磁矩循环</span><br>data_block.add_loop([<br>    [<span class="hljs-string">&quot;_atom_site_label&quot;</span>] + atom_labels,<br>    [<span class="hljs-string">&quot;_atom_site_scalar_magmom&quot;</span>] + [<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;m:<span class="hljs-number">.6</span>f&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> scalar_magmoms]<br>])<br><br><span class="hljs-comment"># 保存修改后的CIF</span><br>alt_filename = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;MP_ID&#125;</span>_alt_scalar_magmoms.cif&quot;</span><br>cif_file.write_file(alt_filename)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;备选方法生成CIF文件: <span class="hljs-subst">&#123;alt_filename&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 打印验证信息</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n标量磁矩值:&quot;</span>)<br><span class="hljs-keyword">for</span> i, magmom <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(scalar_magmoms):<br>    element = structure[i].species_string<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;原子 <span class="hljs-subst">&#123;i&#125;</span> (<span class="hljs-subst">&#123;element&#125;</span>): <span class="hljs-subst">&#123;magmom:<span class="hljs-number">.6</span>f&#125;</span> μB&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="如何读取这些磁矩并加入训练？"><a href="#如何读取这些磁矩并加入训练？" class="headerlink" title="如何读取这些磁矩并加入训练？"></a>如何读取这些磁矩并加入训练？</h2><p>首先，我按照原来的方式读取了原始数据和加入了磁矩的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> csat.crystal_data <span class="hljs-keyword">import</span> CIFData, crystal_graph_list<br><span class="hljs-keyword">from</span> csat.subgraph_data <span class="hljs-keyword">import</span> KhopGraphDataset<br>data = CIFData(<span class="hljs-string">&quot;Ti2O3&quot;</span>, target_name=<span class="hljs-string">&#x27;is_Magnetic&#x27;</span> )<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;这是读取cif文件后的数据&#x27;</span>)<br>graph = crystal_graph_list(data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;这是图数据&#x27;</span>)<br><span class="hljs-built_in">print</span>(graph[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(graph[<span class="hljs-number">0</span>].x)<br>graph_sub = KhopGraphDataset(graph, k_hop=<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;这是子图数据&#x27;</span>)<br><span class="hljs-built_in">print</span>(graph_sub[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure>

<p>两次结果如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">这是读取cif文件后的数据<br><span class="hljs-number">100</span>%|██████████| <span class="hljs-number">1</span>/<span class="hljs-number">1</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">29.05</span>it/s]<br>这是图数据<br>Data(x=[<span class="hljs-number">20</span>, <span class="hljs-number">92</span>], edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">196</span>], edge_attr=[<span class="hljs-number">196</span>, <span class="hljs-number">41</span>], y=[<span class="hljs-number">1</span>], <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;Ti2O3&#x27;</span>)<br>tensor([[<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        ...,<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>]])<br>Extracting <span class="hljs-number">2</span>-hop subgraphs...<br><span class="hljs-number">100</span>%|██████████| <span class="hljs-number">1</span>/<span class="hljs-number">1</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">77.63</span>it/s]<br>Done!<br>这是子图数据<br>Data(x=[<span class="hljs-number">20</span>, <span class="hljs-number">92</span>], edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">196</span>], edge_attr=[<span class="hljs-number">196</span>, <span class="hljs-number">41</span>], y=[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;Ti2O3&#x27;</span>, degree=[<span class="hljs-number">20</span>], complete_edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">400</span>], subgraph_edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">3756</span>], num_subgraph_nodes=<span class="hljs-number">390</span>, subgraph_node_idx=[<span class="hljs-number">390</span>], subgraph_indicator=[<span class="hljs-number">390</span>]<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">这是读取cif文件后的数据<br><span class="hljs-number">100</span>%|██████████| <span class="hljs-number">1</span>/<span class="hljs-number">1</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">27.14</span>it/s]<br>这是图数据<br>Data(x=[<span class="hljs-number">20</span>, <span class="hljs-number">92</span>], edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">196</span>], edge_attr=[<span class="hljs-number">196</span>, <span class="hljs-number">41</span>], y=[<span class="hljs-number">1</span>], <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;Ti2O3&#x27;</span>)<br>tensor([[<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        ...,<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>        [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,  ..., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>]])<br>Extracting <span class="hljs-number">2</span>-hop subgraphs...<br><span class="hljs-number">100</span>%|██████████| <span class="hljs-number">1</span>/<span class="hljs-number">1</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">77.26</span>it/s]<br>Done!<br>这是子图数据<br>Data(x=[<span class="hljs-number">20</span>, <span class="hljs-number">92</span>], edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">196</span>], edge_attr=[<span class="hljs-number">196</span>, <span class="hljs-number">41</span>], y=[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;Ti2O3&#x27;</span>, degree=[<span class="hljs-number">20</span>], complete_edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">400</span>], subgraph_edge_index=[<span class="hljs-number">2</span>, <span class="hljs-number">3756</span>], num_subgraph_nodes=<span class="hljs-number">390</span>, subgraph_node_idx=[<span class="hljs-number">390</span>], subgraph_indicator=[<span class="hljs-number">390</span>])<br></code></pre></td></tr></table></figure>

<p>没有任何区别，说明没有读取到磁矩信息，于是我就要从读取方式上着手，追本溯源。</p>
<p>在原来项目文件中，读取 cif 结构的部分如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pymatgen.core.structure <span class="hljs-keyword">import</span> Structure<br><br>crystal = Structure.from_file(os.path.join(<span class="hljs-variable language_">self</span>.root_dir,<br>                                                   cif_id + <span class="hljs-string">&#x27;.cif&#x27;</span>))<br>        atom_fea = np.vstack([<span class="hljs-variable language_">self</span>.ari.get_atom_fea(crystal[i].specie.number)<br>                              <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal))])<br>        atom_fea = torch.Tensor(atom_fea)<br>        all_nbrs = crystal.get_all_neighbors(<span class="hljs-variable language_">self</span>.radius, include_index=<span class="hljs-literal">True</span>)<br>        all_nbrs = [<span class="hljs-built_in">sorted</span>(nbrs, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> nbrs <span class="hljs-keyword">in</span> all_nbrs]<br>        nbr_fea_idx, nbr_fea = [], []<br>        <span class="hljs-keyword">for</span> nbr <span class="hljs-keyword">in</span> all_nbrs:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(nbr) &lt; <span class="hljs-variable language_">self</span>.max_num_nbr:<br>                warnings.warn(<span class="hljs-string">&#x27;&#123;&#125; not find enough neighbors to build graph. &#x27;</span><br>                              <span class="hljs-string">&#x27;If it happens frequently, consider increase &#x27;</span><br>                              <span class="hljs-string">&#x27;radius.&#x27;</span>.<span class="hljs-built_in">format</span>(cif_id))<br>                nbr_fea_idx.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">2</span>], nbr)) +<br>                                   [<span class="hljs-number">0</span>] * (<span class="hljs-variable language_">self</span>.max_num_nbr - <span class="hljs-built_in">len</span>(nbr)))<br>                nbr_fea.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], nbr)) +<br>                               [<span class="hljs-variable language_">self</span>.radius + <span class="hljs-number">1.</span>] * (<span class="hljs-variable language_">self</span>.max_num_nbr -<br>                                                     <span class="hljs-built_in">len</span>(nbr)))<br>            <span class="hljs-keyword">else</span>:<br>                nbr_fea_idx.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">2</span>],<br>                                            nbr[:<span class="hljs-variable language_">self</span>.max_num_nbr])))<br>                nbr_fea.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>],<br>                                        nbr[:<span class="hljs-variable language_">self</span>.max_num_nbr])))<br>        nbr_fea_idx, nbr_fea = np.array(nbr_fea_idx), np.array(nbr_fea)<br>        nbr_fea = <span class="hljs-variable language_">self</span>.gdf.expand(nbr_fea)<br>        atom_fea = torch.Tensor(atom_fea)<br>        nbr_fea = torch.Tensor(nbr_fea)<br>        nbr_fea_idx = torch.LongTensor(nbr_fea_idx)<br>        target = torch.Tensor([<span class="hljs-built_in">float</span>(target_value)])<br>        <span class="hljs-keyword">return</span> (atom_fea, nbr_fea, nbr_fea_idx), target, cif_id<br></code></pre></td></tr></table></figure>

<p>我们来一步一步测试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pymatgen.core.structure <span class="hljs-keyword">import</span> Structure<br>crystal = Structure.from_file(<span class="hljs-string">&#x27;Ti2O3_m/Ti2O3.cif&#x27;</span>)<br><span class="hljs-built_in">print</span>(crystal)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Full Formula (Ti8 O12)</span><br><span class="hljs-string">Reduced Formula: Ti2O3</span><br><span class="hljs-string">abc   :   5.151007   5.150980   9.476884</span><br><span class="hljs-string">angles:  90.000003  90.000215 120.000080</span><br><span class="hljs-string">pbc   :       True       True       True</span><br><span class="hljs-string">Sites (20)</span><br><span class="hljs-string">  #  SP           a         b         c    magmom</span><br><span class="hljs-string">---  ----  --------  --------  --------  --------</span><br><span class="hljs-string">  0  Ti    0.333333  0.666667  0.975046     0.514</span><br><span class="hljs-string">  1  Ti    0.333333  0.666667  0.249997    -0.112</span><br><span class="hljs-string">  2  Ti    1         1         0.999985     0.906</span><br><span class="hljs-string">  3  Ti    1         2e-06     0.500008     0.906</span><br><span class="hljs-string">  4  Ti    0.333333  0.666667  0.524963     0.514</span><br><span class="hljs-string">  5  Ti    0.666667  0.333333  0.750007    -0.112</span><br><span class="hljs-string">  6  Ti    0.666667  0.333333  0.024937     0.514</span><br><span class="hljs-string">  7  Ti    0.666667  0.333333  0.475051     0.514</span><br><span class="hljs-string">  8  O     0.025681  0.674403  0.116537    -0.007</span><br><span class="hljs-string">  9  O     0.974318  0.648705  0.616563    -0.007</span><br><span class="hljs-string"> 10  O     0.0257    0.351301  0.383472    -0.007</span><br><span class="hljs-string"> 11  O     0.974308  0.325583  0.883429    -0.007</span><br><span class="hljs-string"> 12  O     0.325599  0.351278  0.116537    -0.007</span><br><span class="hljs-string"> 13  O     0.351293  0.32561   0.61656     -0.007</span><br><span class="hljs-string"> 14  O     0.3256    0.974301  0.383477    -0.007</span><br><span class="hljs-string"> 15  O     0.351274  0.02569   0.88343     -0.007</span><br><span class="hljs-string"> 16  O     0.648702  0.674402  0.383477    -0.007</span><br><span class="hljs-string"> 17  O     0.674414  0.648724  0.883429    -0.007</span><br><span class="hljs-string"> 18  O     0.648724  0.974321  0.116535    -0.007</span><br><span class="hljs-string"> 19  O     0.674388  0.025681  0.61656     -0.007</span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br>这里是利用 pymatgen 读取 structure，可以看见跟之前获取时候打印的是一模一样的，而且是含有磁矩的。<br>接下来按照谢天的方法来读取原子特征<br>```python<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-comment"># 原子特征初始化器</span><br><span class="hljs-comment"># 原子特征初始化器</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AtomInitializer</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Base class for intializing the vector representation for atoms.</span><br><span class="hljs-string">    该类的作用是初始化原子的特征表示。</span><br><span class="hljs-string">    初始化过程是通过一个字典将每种元素的原子特征表示存储在内存中。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, atom_types</span>):<br>        <span class="hljs-variable language_">self</span>.atom_types = <span class="hljs-built_in">set</span>(atom_types) <span class="hljs-comment"># 存储原子类型的集合</span><br>        <span class="hljs-variable language_">self</span>._embedding = &#123;&#125; <span class="hljs-comment"># # 核心存储：原子类型 -&gt; 特征向量</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_atom_fea</span>(<span class="hljs-params">self, atom_type</span>):<br>        <span class="hljs-keyword">assert</span> atom_type <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.atom_types<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._embedding[atom_type] <span class="hljs-comment"># 原子序数作为键获取特征向量</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_state_dict</span>(<span class="hljs-params">self, state_dict</span>):<br>        <span class="hljs-variable language_">self</span>._embedding = state_dict<br>        <span class="hljs-variable language_">self</span>.atom_types = <span class="hljs-built_in">set</span>(<span class="hljs-variable language_">self</span>._embedding.keys())<br>        <span class="hljs-variable language_">self</span>._decodedict = &#123;idx: atom_type <span class="hljs-keyword">for</span> atom_type, idx <span class="hljs-keyword">in</span><br>                            <span class="hljs-variable language_">self</span>._embedding.items()&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">state_dict</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._embedding<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">self, idx</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&#x27;_decodedict&#x27;</span>):<br>            <span class="hljs-variable language_">self</span>._decodedict = &#123;idx: atom_type <span class="hljs-keyword">for</span> atom_type, idx <span class="hljs-keyword">in</span><br>                                <span class="hljs-variable language_">self</span>._embedding.items()&#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._decodedict[idx]<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AtomCustomJSONInitializer</span>(<span class="hljs-title class_ inherited__">AtomInitializer</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    继承自 AtomInitializer，专门通过一个 JSON 文件加载原子特征，该文件包含了每种元素的特征向量。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, elem_embedding_file</span>):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(elem_embedding_file) <span class="hljs-keyword">as</span> f:<br>            elem_embedding = json.load(f) <span class="hljs-comment"># 读取 JSON 文件</span><br>            <br>        <span class="hljs-comment"># 将 JSON 中的键转换为整数类型，并将值转换为 NumPy 数组</span><br>        <span class="hljs-comment"># 这样可以确保原子序数作为键，特征向量作为值</span><br>        elem_embedding = &#123;<span class="hljs-built_in">int</span>(key): value <span class="hljs-keyword">for</span> key, value<br>                          <span class="hljs-keyword">in</span> elem_embedding.items()&#125;<br>        <br>        <span class="hljs-comment"># 初始化父类，传入原子类型集合</span><br>        <span class="hljs-comment"># 这里的原子类型是 JSON 文件中的键（整数形式的原子序数）</span><br>        <span class="hljs-comment"># 例如：&#123;6: [0.1, 0.2, ...  ], 8: [0.3, 0.4, ...]&#125;</span><br>        atom_types = <span class="hljs-built_in">set</span>(elem_embedding.keys())<br>        <span class="hljs-comment"># 调用父类构造函数</span><br>        <span class="hljs-built_in">super</span>(AtomCustomJSONInitializer, <span class="hljs-variable language_">self</span>).__init__(atom_types)<br>        <span class="hljs-comment"># 将 JSON 中的特征向量存储到 _embedding 字典中</span><br>        <span class="hljs-comment"># 这里的键是整数形式的原子序数，值是对应的特征向量</span><br>        <span class="hljs-comment"># 例如：&#123;6: np.array([0.1, 0.2</span><br>        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> elem_embedding.items():<br>            <span class="hljs-variable language_">self</span>._embedding[key] = np.array(value, dtype=<span class="hljs-built_in">float</span>)<br><br><br>ari = AtomCustomJSONInitializer(<span class="hljs-string">&#x27;Ti2O3_m/atom_init.json&#x27;</span>)<br><span class="hljs-comment"># 遍历晶体中的每个原子</span><br>atom_fea = np.vstack([ari.get_atom_fea(crystal[i].specie.number)  <span class="hljs-comment"># 获取原子序数的特征向量</span><br>                              <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal))])<br>atom_fea = torch.Tensor(atom_fea)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;这是原子特征&#x27;</span>)<br><span class="hljs-built_in">print</span>(atom_fea)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;结果</span><br><span class="hljs-string">这是原子特征</span><br><span class="hljs-string">tensor([[0., 0., 0.,  ..., 0., 0., 0.],</span><br><span class="hljs-string">        [0., 0., 0.,  ..., 0., 0., 0.],</span><br><span class="hljs-string">        [0., 0., 0.,  ..., 0., 0., 0.],</span><br><span class="hljs-string">        ...,</span><br><span class="hljs-string">        [0., 0., 0.,  ..., 0., 0., 0.],</span><br><span class="hljs-string">        [0., 0., 0.,  ..., 0., 0., 0.],</span><br><span class="hljs-string">        [0., 0., 0.,  ..., 0., 0., 0.]])</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>从这里就可以发现，原子特征是按照 atom_init.json 进行编码的。</p>
<p>这段代码的核心功能是：<strong>将晶体结构中的每个原子转化为数值化特征向量，最终生成一个PyTorch张量。</strong></p>
<p>具体流程：</p>
<ul>
<li>从JSON文件加载预定义的原子特征向量（每个原子序数对应一个特征向量）</li>
<li>遍历晶体中的每个原子，根据其原子序数获取对应特征向量</li>
<li>堆叠所有原子的特征向量形成特征矩阵</li>
<li>转换为PyTorch张量供深度学习模型使用</li>
</ul>
<p>所以他的关键就是这一步 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">atom_fea = np.vstack([ari.get_atom_fea(crystal[i].specie.number)   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal))])<br></code></pre></td></tr></table></figure>

<p>于是我就单独把它拎出来看一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal)):<br>    <span class="hljs-built_in">print</span>(crystal[i].specie.number)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">22</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">8</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>正好是原子序数，这对我以后话题也很有启发</p>
<p><img src="/img/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E5%86%99%E5%85%A5/1.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/%E5%85%B3%E4%BA%8E%E7%A3%81%E7%9F%A9%E7%89%B9%E5%BE%81%E5%86%99%E5%85%A5/2.png" srcset="/img/loading.gif" lazyload></p>
<p>这样子画图就好很多了，而且能检索出元素了。</p>
<p>回归正题，在这里 crystal 变量是可以访问多个参数的，他是源自</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pymatgen.core.structure <span class="hljs-keyword">import</span> Structure <br></code></pre></td></tr></table></figure>

<p>我们就来看这个 Structure 到底是什么</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Structure</span>(IStructure, collections.abc.MutableSequence):<br>    <span class="hljs-string">&quot;&quot;&quot;Mutable version of structure.&quot;&quot;&quot;</span><br><br>    __hash__ = <span class="hljs-literal">None</span>  <span class="hljs-comment"># type: ignore[assignment]</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"></span><br><span class="hljs-params">        self,</span><br><span class="hljs-params">        lattice: ArrayLike | Lattice,</span><br><span class="hljs-params">        species: <span class="hljs-type">Sequence</span>[CompositionLike],</span><br><span class="hljs-params">        coords: <span class="hljs-type">Sequence</span>[ArrayLike] | ArrayLike,</span><br><span class="hljs-params">        charge: <span class="hljs-built_in">float</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">        validate_proximity: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,</span><br><span class="hljs-params">        to_unit_cell: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,</span><br><span class="hljs-params">        coords_are_cartesian: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,</span><br><span class="hljs-params">        site_properties: <span class="hljs-built_in">dict</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">        labels: <span class="hljs-type">Sequence</span>[<span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span>] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">        properties: <span class="hljs-built_in">dict</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">    </span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;Create a periodic structure.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            lattice: The lattice, either as a pymatgen.core.Lattice or</span><br><span class="hljs-string">                simply as any 2D array. Each row should correspond to a lattice</span><br><span class="hljs-string">                vector. e.g. [[10,0,0], [20,10,0], [0,0,30]] specifies a</span><br><span class="hljs-string">                lattice with lattice vectors [10,0,0], [20,10,0] and [0,0,30].</span><br><span class="hljs-string">            species: List of species on each site. Can take in flexible input,</span><br><span class="hljs-string">                including:</span><br><span class="hljs-string"></span><br><span class="hljs-string">                i.  A sequence of element / species specified either as string</span><br><span class="hljs-string">                    symbols, e.g. [&quot;Li&quot;, &quot;Fe2+&quot;, &quot;P&quot;, ...] or atomic numbers,</span><br><span class="hljs-string">                    e.g. (3, 56, ...) or actual Element or Species objects.</span><br><span class="hljs-string"></span><br><span class="hljs-string">                ii. List of dict of elements/species and occupancies, e.g.</span><br><span class="hljs-string">                    [&#123;&quot;Fe&quot; : 0.5, &quot;Mn&quot;:0.5&#125;, ...]. This allows the setup of</span><br><span class="hljs-string">                    disordered structures.</span><br><span class="hljs-string">            coords (Nx3 array): list of fractional/cartesian coordinates of</span><br><span class="hljs-string">                each species.</span><br><span class="hljs-string">            charge (float): overall charge of the structure. Defaults to behavior</span><br><span class="hljs-string">                in SiteCollection where total charge is the sum of the oxidation</span><br><span class="hljs-string">                states.</span><br><span class="hljs-string">            validate_proximity (bool): Whether to check if there are sites</span><br><span class="hljs-string">                that are less than 0.01 Ang apart. Defaults to False.</span><br><span class="hljs-string">            to_unit_cell (bool): Whether to map all sites into the unit cell,</span><br><span class="hljs-string">                i.e., fractional coords between 0 and 1. Defaults to False.</span><br><span class="hljs-string">            coords_are_cartesian (bool): Set to True if you are providing</span><br><span class="hljs-string">                coordinates in Cartesian coordinates. Defaults to False.</span><br><span class="hljs-string">            site_properties (dict): Properties associated with the sites as a</span><br><span class="hljs-string">                dict of sequences, e.g. &#123;&quot;magmom&quot;:[5,5,5,5]&#125;. The sequences</span><br><span class="hljs-string">                have to be the same length as the atomic species and</span><br><span class="hljs-string">                fractional_coords. Defaults to None for no properties.</span><br><span class="hljs-string">            labels (list[str]): Labels associated with the sites as a</span><br><span class="hljs-string">                list of strings, e.g. [&#x27;Li1&#x27;, &#x27;Li2&#x27;]. Must have the same</span><br><span class="hljs-string">                length as the species and fractional coords. Defaults to</span><br><span class="hljs-string">                None for no labels.</span><br><span class="hljs-string">            properties (dict): Properties associated with the whole structure.</span><br><span class="hljs-string">                Will be serialized when writing the structure to JSON or YAML but is</span><br><span class="hljs-string">                lost when converting to other formats.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<p><strong>参数：</strong></p>
<ol>
<li><em><strong>lattice:</strong></em> 晶格参数，可接受pymatgen.core.Lattice对象或任意二维数组。每行对应一个晶格向量，例如[[10,0,0], [20,10,0], [0,0,30]]表示晶格向量[10,0,0]、[20,10,0]和[0,0,30]。</li>
<li><em><strong>species</strong></em>: 各点位元素的种类列表，支持多种输入形式：<ol>
<li>字符串符号（如[“Li”, “Fe2+”, “P”,…]）、原子序数（如(3, 56,…)）或Element&#x2F;Species对象组成的序</li>
<li>由元素&#x2F;物种及占位占比构成的字典列表（如[{“Fe”:0.5, “Mn”:0.5},…]），用于构建无序结构(disordered structures)coords (Nx3数组): 各元素的分数坐标&#x2F;笛卡尔坐标列表</li>
</ol>
</li>
<li><em><strong>charge</strong></em> (float): 结构整体电荷量。默认遵循SiteCollection行为，即总电荷为各点位氧化态之和</li>
<li><em><strong>validate_proximity</strong></em> (bool): 是否检查存在间距小于0.01埃的原子点位，默认为False</li>
<li><em><strong>to_unit_cell</strong></em> (bool): 是否将所有点位映射到单位晶胞内（即分数坐标强制转换到0-1区间），默认为False</li>
<li><em><strong>coords_are_cartesian</strong></em> (bool): True表示提供笛卡尔坐标，False表示分数坐标，默认为False</li>
<li><em><strong>site_properties</strong></em> (dict): 原子点位属性字典，格式为{“属性名”:[值1,值2,…]}，序列长度需与species和coords一致，默认为None</li>
<li><em><strong>labels</strong></em> (list[str]): 原子点位标签列表（如[‘Li1’, ‘Li2’]），长度需与species和coords一致，默认为None</li>
<li><em><strong>properties</strong></em> (dict): 结构整体属性字典，序列化为JSON&#x2F;YAML时保留，但转换为其他格式时会丢失</li>
</ol>
<p>注：  </p>
<ul>
<li>保留pymatgen.core.Lattice、Element、Species等专业对象名不翻译  </li>
<li>晶体学术语如”disordered structures”译为”无序结构”以匹配领域习惯  </li>
<li>坐标类型（笛卡尔&#x2F;分数）的转换逻辑通过参数层次清晰表达  </li>
<li>默认值说明保持与API文档一致的数值精度（如0.01埃）  </li>
<li>数据结构格式（Nx3数组、字典、列表）保持技术文档通用表述  </li>
<li>参数间的数据一致性要求（如长度匹配）使用强调句式突显</li>
</ul>
<h3 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h3><p>以下是针对 <code>pymatgen.core.structure.Structure</code> 对象的详细访问指南，涵盖了其核心属性和方法：</p>
<h4 id="1-基本结构信息"><a href="#1-基本结构信息" class="headerlink" title="1. 基本结构信息"></a>1. 基本结构信息</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 晶胞参数</span><br>lattice = crystal.lattice<br><span class="hljs-built_in">print</span>(lattice.a, lattice.b, lattice.c)  <span class="hljs-comment"># 晶格常数 (Å)</span><br><span class="hljs-built_in">print</span>(lattice.alpha, lattice.beta, lattice.gamma)  <span class="hljs-comment"># 晶格角度 (°)</span><br><span class="hljs-built_in">print</span>(lattice.matrix)  <span class="hljs-comment"># 3x3 晶格向量矩阵</span><br><br><span class="hljs-comment"># 晶体基本信息</span><br><span class="hljs-built_in">print</span>(crystal.formula)  <span class="hljs-comment"># 化学式 (如 &quot;Ti2 O3&quot;)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(crystal))     <span class="hljs-comment"># 原子总数</span><br><span class="hljs-built_in">print</span>(crystal.volume)   <span class="hljs-comment"># 晶胞体积 (Å³)</span><br><span class="hljs-built_in">print</span>(crystal.density)  <span class="hljs-comment"># 密度 (g/cm³)</span><br></code></pre></td></tr></table></figure>

<h4 id="2-原子位点访问"><a href="#2-原子位点访问" class="headerlink" title="2. 原子位点访问"></a>2. 原子位点访问</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 访问单个原子位点</span><br>site = crystal[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 第一个原子位点</span><br><br><span class="hljs-comment"># 原子位点属性</span><br><span class="hljs-built_in">print</span>(site.specie)        <span class="hljs-comment"># 元素对象 (如 Element(&quot;Ti&quot;))</span><br><span class="hljs-built_in">print</span>(site.specie.number) <span class="hljs-comment"># 原子序数 (22)</span><br><span class="hljs-built_in">print</span>(site.specie.symbol) <span class="hljs-comment"># 元素符号 (&quot;Ti&quot;)</span><br><span class="hljs-built_in">print</span>(site.coords)        <span class="hljs-comment"># 笛卡尔坐标 [x, y, z] (Å)</span><br><span class="hljs-built_in">print</span>(site.frac_coords)   <span class="hljs-comment"># 分数坐标 [a, b, c]</span><br><span class="hljs-built_in">print</span>(site.properties)    <span class="hljs-comment"># 附加属性字典</span><br></code></pre></td></tr></table></figure>

<h4 id="3-化学组成分析"><a href="#3-化学组成分析" class="headerlink" title="3. 化学组成分析"></a>3. 化学组成分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 元素组成</span><br><span class="hljs-built_in">print</span>(crystal.composition)          <span class="hljs-comment"># Composition对象 (如 Composition(&quot;Ti2O3&quot;))</span><br><span class="hljs-built_in">print</span>(crystal.composition.reduced_formula)  <span class="hljs-comment"># 最简化学式 (&quot;Ti2O3&quot;)</span><br><span class="hljs-built_in">print</span>(crystal.composition.num_atoms) <span class="hljs-comment"># 总原子数</span><br><span class="hljs-built_in">print</span>(crystal.composition[<span class="hljs-string">&quot;Ti&quot;</span>])     <span class="hljs-comment"># Ti原子数量 (2)</span><br><br><span class="hljs-comment"># 元素分布</span><br><span class="hljs-built_in">print</span>(crystal.atomic_numbers)  <span class="hljs-comment"># 所有原子序数列表 [22, 22, 8, 8, 8]</span><br><span class="hljs-built_in">print</span>(crystal.species)         <span class="hljs-comment"># 所有元素对象列表</span><br></code></pre></td></tr></table></figure>

<h4 id="4-对称性分析-需要spglib"><a href="#4-对称性分析-需要spglib" class="headerlink" title="4. 对称性分析 (需要spglib)"></a>4. 对称性分析 (需要spglib)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 空间群分析</span><br><span class="hljs-built_in">print</span>(crystal.get_space_group_info())  <span class="hljs-comment"># (空间群符号, 国际表编号)</span><br><br><span class="hljs-comment"># 对称操作</span><br><span class="hljs-built_in">print</span>(crystal.get_symmetry_operations())<br><br><span class="hljs-comment"># 等效原子</span><br><span class="hljs-built_in">print</span>(crystal.find_equivalent_sites())<br></code></pre></td></tr></table></figure>

<h4 id="5-结构操作"><a href="#5-结构操作" class="headerlink" title="5. 结构操作"></a>5. 结构操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 结构转换</span><br>crystal.to(fmt=<span class="hljs-string">&quot;poscar&quot;</span>)  <span class="hljs-comment"># 转为VASP POSCAR格式字符串</span><br>crystal.to(filename=<span class="hljs-string">&quot;output.cif&quot;</span>)  <span class="hljs-comment"># 保存为CIF文件</span><br><br><span class="hljs-comment"># 结构操作</span><br>crystal.make_supercell([<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>])  <span class="hljs-comment"># 创建超胞</span><br>crystal.add_site_property(<span class="hljs-string">&quot;charge&quot;</span>, [<span class="hljs-number">0.5</span>]*<span class="hljs-built_in">len</span>(crystal))  <span class="hljs-comment"># 添加自定义属性</span><br></code></pre></td></tr></table></figure>

<h4 id="6-物理性质计算"><a href="#6-物理性质计算" class="headerlink" title="6. 物理性质计算"></a>6. 物理性质计算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 距离/角度计算</span><br><span class="hljs-built_in">print</span>(crystal.get_distance(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))  <span class="hljs-comment"># 原子0和1之间的距离</span><br><span class="hljs-built_in">print</span>(crystal.get_angle(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>))  <span class="hljs-comment"># 原子0-1-2之间的角度</span><br><br><span class="hljs-comment"># 邻居分析</span><br>neighbors = crystal.get_neighbors(site, r=<span class="hljs-number">3.0</span>)  <span class="hljs-comment"># 3Å内的邻居</span><br><span class="hljs-keyword">for</span> neighbor, distance, index <span class="hljs-keyword">in</span> neighbors:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;原子<span class="hljs-subst">&#123;index&#125;</span>(<span class="hljs-subst">&#123;neighbor.specie&#125;</span>) 距离: <span class="hljs-subst">&#123;distance:<span class="hljs-number">.3</span>f&#125;</span>Å&quot;</span>)<br></code></pre></td></tr></table></figure>

<h4 id="7-高级特征"><a href="#7-高级特征" class="headerlink" title="7. 高级特征"></a>7. 高级特征</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 倒易晶格</span><br><span class="hljs-built_in">print</span>(crystal.lattice.reciprocal_lattice)<br><br><span class="hljs-comment"># 磁性分析 (若有自旋信息)</span><br><span class="hljs-built_in">print</span>(crystal.is_ordered)  <span class="hljs-comment"># 是否所有位点有序</span><br><span class="hljs-built_in">print</span>(crystal.spin_states)  <span class="hljs-comment"># 自旋状态</span><br><br><span class="hljs-comment"># 缺陷分析</span><br><span class="hljs-built_in">print</span>(crystal.frac_coords % <span class="hljs-number">1</span>)  <span class="hljs-comment"># 所有原子分数坐标</span><br></code></pre></td></tr></table></figure>

<h4 id="示例应用：获取所有原子坐标"><a href="#示例应用：获取所有原子坐标" class="headerlink" title="示例应用：获取所有原子坐标"></a>示例应用：获取所有原子坐标</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取所有原子的元素符号和笛卡尔坐标</span><br>atom_data = []<br><span class="hljs-keyword">for</span> i, site <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(crystal):<br>    atom_data.append(&#123;<br>        <span class="hljs-string">&quot;id&quot;</span>: i,<br>        <span class="hljs-string">&quot;element&quot;</span>: site.specie.symbol,<br>        <span class="hljs-string">&quot;atomic_number&quot;</span>: site.specie.number,<br>        <span class="hljs-string">&quot;cartesian_coords&quot;</span>: site.coords.tolist(),<br>        <span class="hljs-string">&quot;fractional_coords&quot;</span>: site.frac_coords.tolist()<br>    &#125;)<br><span class="hljs-built_in">print</span>(json.dumps(atom_data, indent=<span class="hljs-number">2</span>))<br></code></pre></td></tr></table></figure>

<p>熟悉了以上之后，便可以获取其原子磁矩了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal)):<br>    <span class="hljs-built_in">print</span>(crystal[i].specie.symbol)<br>    <span class="hljs-built_in">print</span>(crystal.site_properties[<span class="hljs-string">&#x27;magmom&#x27;</span>][i])<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.5139999999963609</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">-0.11199999999920497</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.9059999999935977</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.9059999999935977</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.5139999999963609</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">-0.11199999999920497</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.5139999999963609</span><br><span class="hljs-string">Ti</span><br><span class="hljs-string">0.5139999999963609</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">O</span><br><span class="hljs-string">...</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">O</span><br><span class="hljs-string">-0.006999999999953593</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>现在就要把他加入进编码后的原子特征中，也就是 atom_fea。</p>
<p>首先把磁矩加入单个原子的特征中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">atom_fea_list = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(crystal)):<br>    base_fea = ari.get_atom_fea(crystal[i].specie.number)<br>    magmom  = crystal.site_properties[<span class="hljs-string">&#x27;magmom&#x27;</span>][i] <span class="hljs-comment"># 添加磁矩</span><br>    magmom = <span class="hljs-built_in">float</span>(magmom)  <span class="hljs-comment"># 确保磁矩是浮点数类型</span><br>    <span class="hljs-comment"># 将磁矩作为新特征追加</span><br>    extended_fea = np.append(base_fea, magmom)<br>    <br>    atom_fea_list.append(extended_fea)<br>    <span class="hljs-built_in">print</span>(extended_fea)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[0.    0.    0.    0.    1.    0.    0.    0.    0.    0.    0.    0.</span><br><span class="hljs-string"> 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    1.    0.</span><br><span class="hljs-string"> 0.    0.    0.    0.    1.    0.    0.    0.    0.    0.    0.    0.</span><br><span class="hljs-string"> 0.    0.    0.    0.    1.    0.    0.    0.    0.    0.    0.    0.</span><br><span class="hljs-string"> 0.    1.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.</span><br><span class="hljs-string"> 0.    1.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.</span><br><span class="hljs-string"> 1.    0.    0.    0.    0.    0.    0.    0.    1.    0.    0.    0.</span><br><span class="hljs-string"> 0.    1.    0.    0.    0.    0.    0.    0.    0.514]</span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>再统一封装</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">atom_fea = np.vstack(atom_fea_list)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;这是扩展后的原子特征&#x27;</span>)<br>atom_fea = torch.Tensor(atom_fea)<br><span class="hljs-built_in">print</span>(atom_fea)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.5140],</span><br><span class="hljs-string">        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000, -0.1120],</span><br><span class="hljs-string">        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.9060],</span><br><span class="hljs-string">        ...,</span><br><span class="hljs-string">        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000, -0.0070],</span><br><span class="hljs-string">        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000, -0.0070],</span><br><span class="hljs-string">        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000, -0.0070]])</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%87%9D%E8%81%9A%E6%80%81%E7%89%A9%E7%90%86%E4%B8%8E%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" class="category-chain-item">凝聚态物理与人工智能</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MP/" class="print-no-link">#MP</a>
      
        <a href="/tags/CSAT/" class="print-no-link">#CSAT</a>
      
        <a href="/tags/%E7%A7%91%E7%A0%94/" class="print-no-link">#科研</a>
      
        <a href="/tags/%E5%87%9D%E8%81%9A%E6%80%81%E7%89%A9%E7%90%86/" class="print-no-link">#凝聚态物理</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>关于磁矩特征的写入</div>
      <div>http://baikelwang.github.io/2025/07/09/关于磁矩特征的写入/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>北海</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年7月9日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/09/%E8%AE%AD%E7%BB%83%E5%B8%A6%E6%9C%89%E7%A3%81%E7%9F%A9%E7%9A%84%E6%95%B0%E6%8D%AE/" title="训练带有磁矩的数据">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">训练带有磁矩的数据</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/09/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E9%A1%BA%E5%BA%8F%E8%A1%A8/" title="数据结构第二章：顺序表">
                        <span class="hidden-mobile">数据结构第二章：顺序表</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://www.yuque.com/baikel-408" target="_blank" rel="nofollow noopener"><span>Yuque</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/BaikelWang" target="_blank" rel="nofollow noopener"><span>Github</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
